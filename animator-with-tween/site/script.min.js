!function(){"use strict";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var e={exports:{}};e.exports=class{constructor(t){this.setKeyframes(t),this.discreteProperties=["display","position","float","clear","visibility","overflow","overflow-x","overflow-y","flex-direction","flex-wrap","justify-content","align-items","align-content","order","grid-template-columns","grid-template-rows","grid-template-areas","grid-auto-flow","z-index","table-layout","empty-cells","caption-side","list-style-type","list-style-position","pointer-events","user-select","box-sizing","resize","text-align","text-transform","white-space","word-break","word-wrap","font-style","font-weight","font-variant","background-repeat","background-attachment","background-position","border-style","border-collapse","content","page-break-before","page-break-after","page-break-inside"]}calculateTween(t){const e={},r=100*t,s=new Set(this.keyframes.flatMap((t=>Object.keys(t.styles))));for(const t of s)e[t]=this.interpolateProperty(t,r);return e}interpolateProperty(t,e){if(this.discreteProperties.includes(t))return this.interpolateDiscreteProperty(t,e);const r=this.keyframes.filter((e=>t in e.styles));if(0===r.length)return null;if(1===r.length)return r[0].styles[t];if(e<r[0].percent){const s=r[0],n=r[1]||r[0],a=(e-s.percent)/(n.percent-s.percent),i=s.styles[t],o=n.styles[t];return"transform"===t?this.extrapolateTransform(i,o,a,"below"):this.extrapolateValue(i,o,a,"below")}if(e>r[r.length-1].percent){const s=r.length-1,n=r[s-1]||r[s],a=r[s],i=(e-a.percent)/(a.percent-n.percent),o=n.styles[t],l=a.styles[t];return"transform"===t?this.extrapolateTransform(o,l,i,"above"):this.extrapolateValue(o,l,i,"above")}let s=r[0],n=r[r.length-1];for(let t=0;t<r.length-1;t++)if(e>=r[t].percent&&e<=r[t+1].percent){s=r[t],n=r[t+1];break}const a=s.styles[t],i=n.styles[t],o=(e-s.percent)/(n.percent-s.percent);return"transform"===t?this.interpolateTransform(a,i,o):this.interpolateValue(a,i,o)}extrapolateValue(t,e,r,s){const n=parseFloat(t),a=parseFloat(e);if(isNaN(n)||isNaN(a))return this.formatNumber("above"===s?e:t);let i;return i="above"===s?a+(a-n)*r:"below"===s?n+(n-a)*r:a,this.formatNumber(i)}extrapolateTransform(t,e,r,s){const n=this.parseTransform(t),a=this.parseTransform(e),i=[],o=new Set([...Object.keys(n),...Object.keys(a)]);for(const t of o){const e=n[t]||(this.isNumericFunction(t)?{value:0,unit:"px"}:{value:0,unit:""}),o=a[t]||{value:e.value,unit:e.unit};if(Array.isArray(e.value)){const n=e.value.map(((t,e)=>{const n=o.value[e]||{value:t.value,unit:t.unit};let a=t.value;return"above"===s?a+=(n.value-t.value)*r:"below"===s&&(a+=(t.value-n.value)*r),`${this.formatNumber(a)}${t.unit||""}`}));i.push(`${t}(${n.join(", ")})`)}else{let n=o.value;"above"===s?n+=(o.value-e.value)*r:"below"===s&&(n+=(e.value-o.value)*r),i.push(`${t}(${this.formatNumber(n)}${e.unit||""})`)}}return i.join(" ")}formatNumber(t){return t=parseFloat(t),parseFloat(t.toFixed(4)).toString()}interpolateDiscreteProperty(t,e){const r=this.keyframes.filter((e=>t in e.styles));return 0===r.length?null:r.reduce(((t,r)=>r.percent<=e&&r.percent>t.percent?r:t)).styles[t]}interpolateTransform(t,e,r){const s=this.parseTransform(t),n=this.parseTransform(e),a=[],i=new Set([...Object.keys(s),...Object.keys(n)]);for(const t of i){const e=s[t]||(this.isNumericFunction(t)?{value:0,unit:"px"}:{value:0,unit:""}),i=n[t]||{value:e.value,unit:e.unit};if(Array.isArray(e.value)){const s=e.value.map(((t,e)=>{const s=i.value[e]||{value:t.value,unit:t.unit},n=this.interpolateValue(t.value,s.value,r,!0);return`${this.formatNumber(n)}${t.unit||""}`}));a.push(`${t}(${s.join(", ")})`)}else{const s=this.interpolateValue(e.value,i.value,r,!0);a.push(`${t}(${this.formatNumber(s)}${e.unit||""})`)}}return a.join(" ")}parseTransform(t){const e={},r=/(\w+)\(([^)]+)\)/g;let s;for(;null!==(s=r.exec(t));){const[,t,r]=s,n=r.split(/\s*,\s*|\s+/).map((t=>{const e=t.match(/^(-?\d*\.?\d+)(\D*)$/);return e?{value:parseFloat(e[1]),unit:e[2]}:{value:0,unit:""}}));n.length>1?e[t]=n:e[t]=n[0]}return e}interpolateValue(t,e,r,s=!1){if(this.isColor(t)&&this.isColor(e))return this.interpolateColor(t,e,r);if("number"==typeof t&&"number"==typeof e){const s=t+(e-t)*r;return this.formatNumber(s)}const n=this.parseValue(t),a=this.parseValue(e);if(n&&a&&n.unit===a.unit){let t=(n.value+(a.value-n.value)*r).toFixed(2);return t=t.replace(/\.00$/,"").replace(/(\.\d)0$/,"$1"),`${t}${n.unit||""}`}return r<1?t:e}parseValue(t){if("number"==typeof t)return{value:t,unit:""};const e=String(t).match(/^(-?\d*\.?\d+)(\D*)$/);return e?{value:parseFloat(e[1]),unit:e[2]}:null}isColor(t){return/^(#[0-9A-Fa-f]{6}|rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)|rgba\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*,\s*[\d.]+\s*\)|hsl\(\s*\d+\s*,\s*\d+%\s*,\s*\d+%\s*\)|hsla\(\s*\d+\s*,\s*\d+%\s*,\s*\d+%\s*,\s*[\d.]+\s*\))$/.test(t)}interpolateColor(t,e,r){const s=this.colorToRGB(t),n=this.colorToRGB(e),a=Math.round(s[0]+(n[0]-s[0])*r),i=Math.round(s[1]+(n[1]-s[1])*r),o=Math.round(s[2]+(n[2]-s[2])*r),l=t=>Math.max(0,Math.min(255,t));return`#${((1<<24)+(l(a)<<16)+(l(i)<<8)+l(o)).toString(16).slice(1).toUpperCase()}`}colorToRGB(t){if(t.startsWith("#"))return[parseInt(t.slice(1,3),16),parseInt(t.slice(3,5),16),parseInt(t.slice(5,7),16)];const e=t.match(/^rgb\s*\(\s*(\d+),\s*(\d+),\s*(\d+)\s*\)$/);if(e)return[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10)];const r=t.match(/^rgba\s*\(\s*(\d+),\s*(\d+),\s*(\d+),\s*[\d.]+\s*\)$/);return r?[parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10)]:t.match(/^hsl\s*\(\s*(\d+),\s*(\d+)%?,\s*(\d+)%?\s*\)$/)||t.match(/^hsla\s*\(\s*(\d+),\s*(\d+)%?,\s*(\d+)%?,\s*[\d.]+\s*\)$/)?this.hslToRGB(t):[0,0,0]}hslToRGB(t){const e=t.match(/^hsl[a]?\(\s*(\d+),\s*(\d+)%?,\s*(\d+)%?\s*\)$/);if(!e)return[0,0,0];let r=parseInt(e[1],10),s=parseInt(e[2],10)/100,n=parseInt(e[3],10)/100;r%=360,r<0&&(r+=360);const a=(1-Math.abs(2*n-1))*s,i=a*(1-Math.abs(r/60%2-1)),o=n-a/2;let l,u,c;return[l,u,c]=0<=r&&r<60?[a,i,0]:60<=r&&r<120?[i,a,0]:120<=r&&r<180?[0,a,i]:180<=r&&r<240?[0,i,a]:240<=r&&r<300?[i,0,a]:[a,0,i],[Math.round(255*(l+o)),Math.round(255*(u+o)),Math.round(255*(c+o))]}setKeyframes(t){this.keyframes=t.sort(((t,e)=>t.percent-e.percent))}isNumericFunction(t){return["translate","translateX","translateY","translateZ","scale","scaleX","scaleY","scaleZ","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY","perspective"].includes(t)}interpolateDiscreteProperty(t,e){const r=this.keyframes.filter((e=>t in e.styles));return 0===r.length?null:r.reduce(((t,r)=>r.percent<=e&&r.percent>t.percent?r:t)).styles[t]}};var r=t(e.exports),s={exports:{}};!function(t){var e,r;(e=self.document)&&!e.getElementById("livereloadscript")&&((r=e.createElement("script")).async=1,r.src="//"+(self.location.host||"localhost").split(":")[0]+":35730/livereload.js?snipver=1",r.id="livereloadscript",e.getElementsByTagName("head")[0].appendChild(r)),t.exports=function(){!function(t){class DPEventEmitter{#t;constructor(){this.#t=new Map}on(t,e){if("function"!=typeof e)throw new TypeError("Listener must be a function");const r=this.#t.get(t)||[];return r.includes(e)||r.push(e),this.#t.set(t,r),this}off(t,e){const r=this.#t.get(t);if(!r)return this;const s=r.indexOf(e);return-1!==s&&(r.splice(s,1),0===r.length?this.#t.delete(t):this.#t.set(t,r)),this}emit(t,...e){const r=this.#t.get(t);if(!r||0===r.length)return!1;for(let s=0,n=r.length;s<n;++s)try{r[s].apply(this,e)}catch(e){console.error(`Error in listener for event '${t}':`,e)}return!0}removeAllListeners(t){return t?this.#t.delete(t):this.#t.clear(),this}}t.exports?t.exports=DPEventEmitter:"undefined"!=typeof window&&(window.DPEventEmitter=DPEventEmitter)}({exports:{}});class PhysicsAnimator{constructor({attraction:t=.026,friction:e=.28}={}){if("number"!=typeof t||t<0||t>1)throw new Error("Attraction must be a number between 0 and 1.");if("number"!=typeof e||e<0||e>1)throw new Error("Friction must be a number between 0 and 1.");this.attraction=t,this.friction=e,this.frictionFactor=1-e,this.velocity=0,this.currentValue=0,this.targetValue=0,this.isAnimating=!1,this.prevTime=null}animateTo(t,e,r,s){return new Promise((n=>{this.currentValue=t,this.targetValue=e,this.velocity=r,this.isAnimating=!0,this.prevTime=null;const a=e=>{if(!this.isAnimating)return;if(null===this.prevTime)return this.prevTime=e,void requestAnimationFrame(a);const r=(e-this.prevTime)/16.66;this.prevTime=e;const i=(this.targetValue-this.currentValue)*this.attraction;this.velocity+=i*r,this.velocity*=Math.pow(this.frictionFactor,r),this.currentValue+=this.velocity*r;const o=this.targetValue-t,l=this.currentValue-t;let u=0;if(0!==o&&(u=l/o),s({position:this.currentValue,progress:u}),Math.abs(this.currentValue-this.targetValue)<.01)return this.isAnimating=!1,s({position:this.targetValue,progress:1}),void n();requestAnimationFrame(a)};requestAnimationFrame(a)}))}stop(){this.isAnimating=!1}setAttraction(t){if("number"!=typeof t||t<0||t>1)throw new Error("Attraction must be a number between 0 and 1.");this.attraction=t}setFriction(t){if("number"!=typeof t||t<0||t>1)throw new Error("Friction must be a number between 0 and 1.");this.friction=t,this.frictionFactor=1-t}}return PhysicsAnimator}()}(s);const n=new(t(s.exports))({attraction:.01,friction:.05}),a=[{percent:0,styles:{transform:"translateX(0px) translateY(0px) rotate(0deg) scale(1.0)",backgroundColor:"#ff0000",borderWidth:"1px"}},{percent:100,styles:{transform:"translateX(400px) translateY(400px) rotate(-360deg) scale(2.0)",backgroundColor:"#ff00ff",borderWidth:"10px"}}],i=[{percent:0,styles:{transform:"translateX(400px)  translateY(400px) rotate(-720deg) scale(2.0)",backgroundColor:"#ff00ff",borderWidth:"10px"}},{percent:100,styles:{transform:"translateX(50px)  translateY(50px) rotate(0deg) scale(0.5)",backgroundColor:"#f0f000",borderWidth:"1px"}}],o=new r(a),l=document.getElementById("box");function u({position:t,progress:e}){const r=o.calculateTween(e);!function(t,e){for(const[r,s]of Object.entries(e))t.style[r]=s}(l,r)}document.getElementById("go").addEventListener("click",(function(t){o.setKeyframes(a),n.animateTo(0,500,20,u).then((()=>{console.log("finished"),o.setKeyframes(i),setTimeout((()=>{n.animateTo(0,500,50,u)}),1e3)}))}))}();
