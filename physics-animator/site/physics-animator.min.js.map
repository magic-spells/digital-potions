{"version":3,"file":"physics-animator.min.js","sources":["../../event-emitter/dp-event-emitter.js","../src/physics-animator.js"],"sourcesContent":["class DPEventEmitter {\n  #events;\n\n  constructor() {\n    this.#events = new Map();\n  }\n\n  /**\n   * Binds a listener to an event.\n   * @param {string} event - The event to bind the listener to.\n   * @param {Function} listener - The listener function to bind.\n   * @returns {DPEventEmitter} The current instance for chaining.\n   * @throws {TypeError} If the listener is not a function.\n   */\n  on(event, listener) {\n    if (typeof listener !== 'function') {\n      throw new TypeError('Listener must be a function');\n    }\n\n    const listeners = this.#events.get(event) || [];\n    if (!listeners.includes(listener)) {\n      listeners.push(listener);\n    }\n    this.#events.set(event, listeners);\n\n    return this;\n  }\n\n  /**\n   * Unbinds a listener from an event.\n   * @param {string} event - The event to unbind the listener from.\n   * @param {Function} listener - The listener function to unbind.\n   * @returns {DPEventEmitter} The current instance for chaining.\n   */\n  off(event, listener) {\n    const listeners = this.#events.get(event);\n    if (!listeners) return this;\n\n    const index = listeners.indexOf(listener);\n    if (index !== -1) {\n      listeners.splice(index, 1);\n      if (listeners.length === 0) {\n        this.#events.delete(event);\n      } else {\n        this.#events.set(event, listeners);\n      }\n    }\n\n    return this;\n  }\n\n  /**\n   * Triggers an event and calls all bound listeners.\n   * @param {string} event - The event to trigger.\n   * @param {...*} args - Arguments to pass to the listener functions.\n   * @returns {boolean} True if the event had listeners, false otherwise.\n   */\n  emit(event, ...args) {\n    const listeners = this.#events.get(event);\n    if (!listeners || listeners.length === 0) return false;\n\n    for (let i = 0, n = listeners.length; i < n; ++i) {\n      try {\n        listeners[i].apply(this, args);\n      } catch (error) {\n        console.error(`Error in listener for event '${event}':`, error);\n      }\n    }\n\n    return true;\n  }\n\n\n  /**\n   * Removes all listeners for a specific event or all events.\n   * @param {string} [event] - The event to remove listeners from. If not provided, removes all listeners.\n   * @returns {DPEventEmitter} The current instance for chaining.\n   */\n  removeAllListeners(event) {\n    if (event) {\n      this.#events.delete(event);\n    } else {\n      this.#events.clear();\n    }\n    return this;\n  }\n}\n\n// Conditional export as Universal Module\nif (typeof module !== 'undefined' && module.exports) {\n    // CommonJS (Node.js) export\n    module.exports = DPEventEmitter;\n} else if (typeof define === 'function' && define.amd) {\n    // AMD (RequireJS) export\n    define([], () => DPEventEmitter);\n} else if (typeof window !== 'undefined') {\n    // Browser global export\n    window.DPEventEmitter = DPEventEmitter;\n}","\nimport EventEmitter from '../../event-emitter/dp-event-emitter';\n\nexport default class PhysicsAnimator {\n\n\t/**\n\t * Creates an instance of PhysicsAnimator.\n\t * @param {number} [attraction=0.026] - The attraction value for physics-based animation (0 < attraction < 1).\n\t * @param {number} [friction=0.28] - The friction value for physics-based animation (0 < friction < 1).\n\t */\n\tconstructor({ attraction = 0.026, friction = 0.28 } = {}) {\n\n\t\t// Validate attraction\n\t\tif (typeof attraction !== 'number' || attraction < 0 || attraction > 1) {\n\t\t\tthrow new Error('Attraction must be a number between 0 and 1.');\n\t\t}\n\t\t// Validate friction\n\t\tif (typeof friction !== 'number' || friction < 0 || friction > 1) {\n\t\t\tthrow new Error('Friction must be a number between 0 and 1.');\n\t\t}\n\n\t\tthis.attraction = attraction;\n\t\tthis.friction = friction;\n\t\tthis.frictionFactor = 1 - friction;\n\n\t\tthis.velocity = 0;\n\t\tthis.currentValue = 0;\n\t\tthis.targetValue = 0;\n\n\t\tthis.isAnimating = false;\n\t\tthis.prevTime = null;\n\t}\n\n\t/**\n\t * Animates from a start value to an end value.\n\t * @param {number} startValue - The starting value.\n\t * @param {number} endValue - The target value.\n\t * @param {function} callback - A callback function that receives the current value and progress.\n\t */\n\tanimateTo(startValue, endValue, velocity, callback) {\n\n\t\treturn new Promise((resolve) => {\n\n\t\t\tthis.currentValue = startValue;\n\t\t\tthis.targetValue = endValue;\n\t\t\tthis.velocity = velocity;\n\t\t\tthis.isAnimating = true;\n\t\t\tthis.prevTime = null;\n\n\t\t\tconst animate = (time) => {\n\t\t\t\tif (!this.isAnimating) return;\n\n\t\t\t\tif (this.prevTime === null) {\n\t\t\t\t\tthis.prevTime = time;\n\t\t\t\t\trequestAnimationFrame(animate);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst timeDelta = time - this.prevTime;\n\t\t\t\tconst timeDeltaFactor = timeDelta / 16.66; // Assuming 60 FPS baseline\n\n\t\t\t\tthis.prevTime = time;\n\n\t\t\t\t// Calculate attraction force\n\t\t\t\tconst force = (this.targetValue - this.currentValue) * this.attraction;\n\n\t\t\t\t// Update velocity\n\t\t\t\tthis.velocity += (force * timeDeltaFactor);\n\n\t\t\t\t// Apply friction\n\t\t\t\tthis.velocity *= Math.pow(this.frictionFactor, timeDeltaFactor);\n\n\t\t\t\t// Update current value\n\t\t\t\tthis.currentValue += this.velocity * timeDeltaFactor;\n\n\t\t\t\t// Calculate progress\n\t\t\t\tconst totalDistance = this.targetValue - startValue;\n\t\t\t\tconst distanceCovered = this.currentValue - startValue;\n\t\t\t\tlet progress = 0;\n\t\t\t\tif (totalDistance !== 0) {\n\t\t\t\t\tprogress = distanceCovered / totalDistance;\n\t\t\t\t}\n\n\t\t\t\t// Call the callback with the current value and progress\n\t\t\t\t// callback(this.currentValue, progress);\n\t\t\t\tcallback({ position: this.currentValue, progress: progress})\n\n\t\t\t\t// Check if animation is complete\n\t\t\t\tif (Math.abs(this.currentValue - this.targetValue) < 0.01) {\n\t\t\t\t\tthis.isAnimating = false;\n\t\t\t\t\tcallback({ position: this.targetValue, progress: 1}); // Ensure we call the callback with final value\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\trequestAnimationFrame(animate);\n\t\t\t};\n\n\t\t\trequestAnimationFrame(animate);\n\n\t\t});\n\t}\n\n\t/**\n\t * Stops the ongoing animation.\n\t */\n\tstop() {\n\t\tthis.isAnimating = false;\n\t}\n\n\n\tsetAttraction(attraction){\n\t\tif (typeof attraction !== 'number' || attraction < 0 || attraction > 1) {\n\t\t\tthrow new Error('Attraction must be a number between 0 and 1.');\n\t\t}\n\t\tthis.attraction = attraction;\n\t}\n\n\tsetFriction(friction){\n\t\tif (typeof friction !== 'number' || friction < 0 || friction > 1) {\n\t\t\tthrow new Error('Friction must be a number between 0 and 1.');\n\t\t}\n\t\tthis.friction = friction;\n\t\tthis.frictionFactor = 1 - friction;\n\t}\n}\n\n"],"names":[],"mappings":";;;;;;;;;;;EAAA,CAAA,MAAM,cAAc,CAAC;EACrB,GAAE,OAAO,CAAC;AACV;EACA,GAAE,WAAW,GAAG;EAChB,KAAI,IAAI,CAAC,OAAO,GAAG,IAAI,GAAG,EAAE,CAAC;MAC1B;AACH;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,GAAE,EAAE,CAAC,KAAK,EAAE,QAAQ,EAAE;EACtB,KAAI,IAAI,OAAO,QAAQ,KAAK,UAAU,EAAE;EACxC,OAAM,MAAM,IAAI,SAAS,CAAC,6BAA6B,CAAC,CAAC;QACpD;AACL;EACA,KAAI,MAAM,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;OAChD,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE;EACvC,OAAM,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC1B;OACD,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;AACvC;OACI,OAAO,IAAI,CAAC;MACb;AACH;EACA;EACA;EACA;EACA;EACA;EACA;EACA,GAAE,GAAG,CAAC,KAAK,EAAE,QAAQ,EAAE;OACnB,MAAM,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;EAC9C,KAAI,IAAI,CAAC,SAAS,EAAE,OAAO,IAAI,CAAC;AAChC;OACI,MAAM,KAAK,GAAG,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;EAC9C,KAAI,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;SAChB,SAAS,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;EACjC,OAAM,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;WAC1B,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;EACnC,QAAO,MAAM;WACL,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;UACpC;QACF;AACL;OACI,OAAO,IAAI,CAAC;MACb;AACH;EACA;EACA;EACA;EACA;EACA;EACA;EACA,GAAE,IAAI,CAAC,KAAK,EAAE,GAAG,IAAI,EAAE;OACnB,MAAM,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;EAC9C,KAAI,IAAI,CAAC,SAAS,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE,OAAO,KAAK,CAAC;AAC3D;EACA,KAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;EACtD,OAAM,IAAI;WACF,SAAS,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;UAChC,CAAC,OAAO,KAAK,EAAE;EACtB,SAAQ,OAAO,CAAC,KAAK,CAAC,CAAC,6BAA6B,EAAE,KAAK,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;UACjE;QACF;AACL;OACI,OAAO,IAAI,CAAC;MACb;AACH;AACA;EACA;EACA;EACA;EACA;EACA;KACE,kBAAkB,CAAC,KAAK,EAAE;OACxB,IAAI,KAAK,EAAE;SACT,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;EACjC,MAAK,MAAM;EACX,OAAM,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;QACtB;OACD,OAAO,IAAI,CAAC;MACb;IACF;AACD;EACA;EACA,CAAA,IAAqC,MAAM,CAAC,OAAO,EAAE;EACrD;OACI,MAAA,CAAA,OAAA,GAAiB,cAAc,CAAC;IACnC,MAGM,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;EAC1C;EACA,KAAI,MAAM,CAAC,cAAc,GAAG,cAAc,CAAC;EAC3C,EAAA;;;EC/Fe,MAAM,eAAe,CAAC;AACrC;EACA;EACA;EACA;EACA;EACA;EACA,CAAC,WAAW,CAAC,EAAE,UAAU,GAAG,KAAK,EAAE,QAAQ,GAAG,IAAI,EAAE,GAAG,EAAE,EAAE;AAC3D;EACA;EACA,EAAE,IAAI,OAAO,UAAU,KAAK,QAAQ,IAAI,UAAU,GAAG,CAAC,IAAI,UAAU,GAAG,CAAC,EAAE;EAC1E,GAAG,MAAM,IAAI,KAAK,CAAC,8CAA8C,CAAC,CAAC;EACnE,GAAG;EACH;EACA,EAAE,IAAI,OAAO,QAAQ,KAAK,QAAQ,IAAI,QAAQ,GAAG,CAAC,IAAI,QAAQ,GAAG,CAAC,EAAE;EACpE,GAAG,MAAM,IAAI,KAAK,CAAC,4CAA4C,CAAC,CAAC;EACjE,GAAG;AACH;EACA,EAAE,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;EAC/B,EAAE,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;EAC3B,EAAE,IAAI,CAAC,cAAc,GAAG,CAAC,GAAG,QAAQ,CAAC;AACrC;EACA,EAAE,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC;EACpB,EAAE,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC;EACxB,EAAE,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC;AACvB;EACA,EAAE,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;EAC3B,EAAE,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;EACvB,EAAE;AACF;EACA;EACA;EACA;EACA;EACA;EACA;EACA,CAAC,SAAS,CAAC,UAAU,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE;AACrD;EACA,EAAE,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,KAAK;AAClC;EACA,GAAG,IAAI,CAAC,YAAY,GAAG,UAAU,CAAC;EAClC,GAAG,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC;EAC/B,GAAG,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;EAC5B,GAAG,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;EAC3B,GAAG,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;AACxB;EACA,GAAG,MAAM,OAAO,GAAG,CAAC,IAAI,KAAK;EAC7B,IAAI,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,OAAO;AAClC;EACA,IAAI,IAAI,IAAI,CAAC,QAAQ,KAAK,IAAI,EAAE;EAChC,KAAK,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;EAC1B,KAAK,qBAAqB,CAAC,OAAO,CAAC,CAAC;EACpC,KAAK,OAAO;EACZ,KAAK;AACL;EACA,IAAI,MAAM,SAAS,GAAG,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC;EAC3C,IAAI,MAAM,eAAe,GAAG,SAAS,GAAG,KAAK,CAAC;AAC9C;EACA,IAAI,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;AACzB;EACA;EACA,IAAI,MAAM,KAAK,GAAG,CAAC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,UAAU,CAAC;AAC3E;EACA;EACA,IAAI,IAAI,CAAC,QAAQ,KAAK,KAAK,GAAG,eAAe,CAAC,CAAC;AAC/C;EACA;EACA,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,EAAE,eAAe,CAAC,CAAC;AACpE;EACA;EACA,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,QAAQ,GAAG,eAAe,CAAC;AACzD;EACA;EACA,IAAI,MAAM,aAAa,GAAG,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC;EACxD,IAAI,MAAM,eAAe,GAAG,IAAI,CAAC,YAAY,GAAG,UAAU,CAAC;EAC3D,IAAI,IAAI,QAAQ,GAAG,CAAC,CAAC;EACrB,IAAI,IAAI,aAAa,KAAK,CAAC,EAAE;EAC7B,KAAK,QAAQ,GAAG,eAAe,GAAG,aAAa,CAAC;EAChD,KAAK;AACL;EACA;EACA;EACA,IAAI,QAAQ,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,YAAY,EAAE,QAAQ,EAAE,QAAQ,CAAC,EAAC;AAChE;EACA;EACA,IAAI,IAAI,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,IAAI,EAAE;EAC/D,KAAK,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;EAC9B,KAAK,QAAQ,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,WAAW,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAC;EAC1D,KAAK,OAAO,EAAE,CAAC;EACf,KAAK,OAAO;EACZ,KAAK;AACL;EACA,IAAI,qBAAqB,CAAC,OAAO,CAAC,CAAC;EACnC,IAAI,CAAC;AACL;EACA,GAAG,qBAAqB,CAAC,OAAO,CAAC,CAAC;AAClC;EACA,GAAG,CAAC,CAAC;EACL,EAAE;AACF;EACA;EACA;EACA;EACA,CAAC,IAAI,GAAG;EACR,EAAE,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;EAC3B,EAAE;AACF;AACA;EACA,CAAC,aAAa,CAAC,UAAU,CAAC;EAC1B,EAAE,IAAI,OAAO,UAAU,KAAK,QAAQ,IAAI,UAAU,GAAG,CAAC,IAAI,UAAU,GAAG,CAAC,EAAE;EAC1E,GAAG,MAAM,IAAI,KAAK,CAAC,8CAA8C,CAAC,CAAC;EACnE,GAAG;EACH,EAAE,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;EAC/B,EAAE;AACF;EACA,CAAC,WAAW,CAAC,QAAQ,CAAC;EACtB,EAAE,IAAI,OAAO,QAAQ,KAAK,QAAQ,IAAI,QAAQ,GAAG,CAAC,IAAI,QAAQ,GAAG,CAAC,EAAE;EACpE,GAAG,MAAM,IAAI,KAAK,CAAC,4CAA4C,CAAC,CAAC;EACjE,GAAG;EACH,EAAE,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;EAC3B,EAAE,IAAI,CAAC,cAAc,GAAG,CAAC,GAAG,QAAQ,CAAC;EACrC,EAAE;EACF;;;;;;;;"}